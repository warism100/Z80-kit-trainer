0000   21 00 80               LD   hl,8000h   
0003                START:       ;first convertion for H
0003   E5                     PUSH   hl   
0004   7C                     LD   a,h   
0005   F5                     PUSH   af   
0006   07                     RLCA      
0007   07                     RLCA      
0008   07                     RLCA      
0009   07                     RLCA      
000A   E6 0F                  AND   0fh   
000C   11 2F 01               LD   de,table   
000F   83                     ADD   a,e   
0010   5F                     LD   e,a   
0011   1A                     LD   a,(de)   
0012   D3 03                  OUT   (03h),a   
0014   3E 20                  LD   a,20h   
0016   D3 04                  OUT   (04h),a   
0018   3E 00                  LD   a,00h   
001A   D3 04                  OUT   (04h),a   
001C   CD 29 01               CALL   delay   
001F   F1                     POP   af   
0020                             ; second convertion for H
0020   7C                     LD   a,h   
0021   E6 0F                  AND   0fh   
0023   11 2F 01               LD   de,table   
0026   83                     ADD   a,e   
0027   5F                     LD   e,a   
0028   1A                     LD   a,(de)   
0029   D3 03                  OUT   (03h),a   
002B   3E 10                  LD   a,10h   
002D   D3 04                  OUT   (04h),a   
002F   3E 00                  LD   a,00h   
0031   D3 04                  OUT   (04h),a   
0033                             ;first convertion for L
0033   7D                     LD   a,l   
0034   F5                     PUSH   af   
0035   07                     RLCA      
0036   07                     RLCA      
0037   07                     RLCA      
0038   07                     RLCA      
0039   E6 0F                  AND   0fh   
003B   11 2F 01               LD   de,table   
003E   83                     ADD   a,e   
003F   5F                     LD   e,a   
0040   1A                     LD   a,(de)   
0041   D3 03                  OUT   (03h),a   
0043   3E 08                  LD   a,08h   
0045   D3 04                  OUT   (04h),a   
0047   3E 00                  LD   a,00h   
0049   D3 04                  OUT   (04h),a   
004B   CD 29 01               CALL   delay   
004E   F1                     POP   af   
004F                             ;second convertion for L
004F   7D                     LD   a,l   
0050   E6 0F                  AND   0fh   
0052   11 2F 01               LD   de,table   
0055   83                     ADD   a,e   
0056   5F                     LD   e,a   
0057   1A                     LD   a,(de)   
0058   D3 03                  OUT   (03h),a   
005A   3E 04                  LD   a,04h   
005C   D3 04                  OUT   (04h),a   
005E   3E 00                  LD   a,00h   
0060   D3 04                  OUT   (04h),a   
0062                             ;first convertion for A
0062   E1                     POP   hl   
0063   7E                     LD   a,(hl)   
0064   4F                     LD   c,a   
0065   79                     LD   a,c   
0066   F5                     PUSH   af   
0067   07                     RLCA      
0068   07                     RLCA      
0069   07                     RLCA      
006A   07                     RLCA      
006B   E6 0F                  AND   0fh   
006D   11 2F 01               LD   de,table   
0070   83                     ADD   a,e   
0071   5F                     LD   e,a   
0072   1A                     LD   a,(de)   
0073   D3 03                  OUT   (03h),a   
0075   3E 02                  LD   a,02h   
0077   D3 04                  OUT   (04h),a   
0079   3E 00                  LD   a,00h   
007B   D3 04                  OUT   (04h),a   
007D   CD 29 01               CALL   delay   
0080   F1                     POP   af   
0081                             ;second convertion for A
0081   E6 0F                  AND   0fh   
0083   11 2F 01               LD   de,table   
0086   83                     ADD   a,e   
0087   5F                     LD   e,a   
0088   1A                     LD   a,(de)   
0089   D3 03                  OUT   (03h),a   
008B   3E 01                  LD   a,01h   
008D   D3 04                  OUT   (04h),a   
008F   3E 00                  LD   a,00h   
0091   D3 04                  OUT   (04h),a   
0093                             ;key test
0093   DB 01                  IN   a,(01h)   
0095   CB 7F                  BIT   7,a   
0097   C2 EC 00               JP   nz,hexcon1   
009A   CB 77                  BIT   6,a   
009C   C2 B6 00               JP   nz,l2   
009F   CB 6F                  BIT   5,a   
00A1   C2 BA 00               JP   nz,l3   
00A4   CB 67                  BIT   4,a   
00A6   C2 BE 00               JP   nz,l4   
00A9   C3 03 00               JP   start   
00AC                             ; wait until strobe = 0
00AC   DB 01        WAIT:     IN   a,(01h)   
00AE   CB 7F                  BIT   7,a   
00B0   C2 AC 00               JP   nz,wait   
00B3   C3 C9 00               JP   next   
00B6   23           L2:       INC   hl   
00B7   C3 BF 00               JP   l5   
00BA   2B           L3:       DEC   hl   
00BB   C3 BF 00               JP   l5   
00BE   E9           L4:       JP   (hl)   
00BF                             ;if contenant of A egals 0 then jump to start
00BF   DB 01        L5:       IN   a,(01h)   
00C1   FE 00                  CP   00h   
00C3   CA 03 00               JP   z,start   
00C6   C3 BF 00               JP   l5   
00C9   DB 01        NEXT:     IN   a,(01h)   
00CB   CB 7F                  BIT   7,a   
00CD   C2 0E 01               JP   nz,hexcon2   
00D0   CB 77                  BIT   6,a   
00D2   C2 B6 00               JP   nz,l2   
00D5   CB 6F                  BIT   5,a   
00D7   C2 BA 00               JP   nz,l3   
00DA   CB 67                  BIT   4,a   
00DC   C2 BE 00               JP   nz,l4   
00DF   C3 C9 00               JP   next   
00E2                             ; wait until strobe = 0
00E2   DB 01        WAIT1:    IN   a,(01h)   
00E4   CB 7F                  BIT   7,a   
00E6   C2 E2 00               JP   nz,wait1   
00E9   C3 03 00               JP   start   
00EC   F5           HEXCON1:   PUSH   af   
00ED   E6 0F                  AND   0fh   
00EF   11 2F 01               LD   de,table   
00F2   83                     ADD   a,e   
00F3   5F                     LD   e,a   
00F4   1A                     LD   a,(de)   
00F5   D3 03                  OUT   (03h),a   
00F7   3E 02                  LD   a,02h   
00F9   D3 04                  OUT   (04h),a   
00FB   3E 00                  LD   a,00h   
00FD   D3 04                  OUT   (04h),a   
00FF   CD 29 01               CALL   delay   
0102   F1                     POP   af   
0103   E6 0F                  AND   0fh   
0105   77                     LD   (hl),a   
0106   17                     RLA      
0107   17                     RLA      
0108   17                     RLA      
0109   17                     RLA      
010A   47                     LD   b,a   
010B   C3 AC 00               JP   wait   
010E                HEXCON2:      
010E   F5                     PUSH   af   
010F   E6 0F                  AND   0fh   
0111   11 2F 01               LD   de,table   
0114   83                     ADD   a,e   
0115   5F                     LD   e,a   
0116   1A                     LD   a,(de)   
0117   D3 03                  OUT   (03h),a   
0119   3E 01                  LD   a,01h   
011B   D3 04                  OUT   (04h),a   
011D   3E 00                  LD   a,00h   
011F   D3 04                  OUT   (04h),a   
0121   F1                     POP   af   
0122   E6 0F                  AND   0fh   
0124   80                     ADD   a,b   
0125   77                     LD   (hl),a   
0126   C3 E2 00               JP   wait1   
0129                             ; dalay
0129   06 10        DELAY:    LD   b,10h   
012B   05           LOOP:     DEC   b   
012C   10 FD                  DJNZ   loop   
012E   C9                     RET      
012F                             ; convertion  table  bin to 7 segment display
012F   3F 06 5B 57 66 75 7D 07 7F 77 6F 7C 39 5E 79 69 TABLE:   DB   03fh,006h,05bh,057h,066h,075h,07dh,007h,07fh,077h,06fh,07ch,039h,05eh,079h,069h   


START:              0003 DEFINED AT LINE 2
                    > USED AT LINE 108
                    > USED AT LINE 127
                    > USED AT LINE 147
WAIT:               00AC DEFINED AT LINE 110
                    > USED AT LINE 112
                    > USED AT LINE 170
L2:                 00B6 DEFINED AT LINE 115
                    > USED AT LINE 103
                    > USED AT LINE 135
L3:                 00BA DEFINED AT LINE 118
                    > USED AT LINE 105
                    > USED AT LINE 137
L4:                 00BE DEFINED AT LINE 121
                    > USED AT LINE 107
                    > USED AT LINE 139
L5:                 00BF DEFINED AT LINE 125
                    > USED AT LINE 116
                    > USED AT LINE 119
                    > USED AT LINE 128
NEXT:               00C9 DEFINED AT LINE 131
                    > USED AT LINE 113
                    > USED AT LINE 140
WAIT1:              00E2 DEFINED AT LINE 144
                    > USED AT LINE 146
                    > USED AT LINE 188
HEXCON1:            00EC DEFINED AT LINE 150
                    > USED AT LINE 101
HEXCON2:            010E DEFINED AT LINE 172
                    > USED AT LINE 133
DELAY:              0129 DEFINED AT LINE 194
                    > USED AT LINE 20
                    > USED AT LINE 51
                    > USED AT LINE 85
                    > USED AT LINE 161
LOOP:               012B DEFINED AT LINE 195
                    > USED AT LINE 196
TABLE:              012F DEFINED AT LINE 199
                    > USED AT LINE 11
                    > USED AT LINE 25
                    > USED AT LINE 42
                    > USED AT LINE 56
                    > USED AT LINE 76
                    > USED AT LINE 89
                    > USED AT LINE 152
                    > USED AT LINE 175
